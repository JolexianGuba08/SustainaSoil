{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Sign In | SustainAsoil</title>
    <!-- Tab Icon -->
    <link rel="icon" type="image/x-icon" href="{% static 'images/logo-secondary.png' %}"/>

    <!-- Include DaisyUi -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet" type="text/css"/>
    <!-- Include Tailwind -->
    <link href="{% static 'css/output.css' %}" rel="stylesheet" type="text/css"/>
    <!-- Include CSS -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet" type="text/css"/>
</head>
<body
        class="content min-h-screen flex flex-col font-sans bg-gradient-to-r from-g1 to-background"
>
<!-- Navbar -->
<div
        class="navbar sm:w-[100%] sm:pl-4 xl:w-[65%] xl:m-auto pt-4 max-xl:flex max-xl:justify-center"
>
    <img
            src="{% static 'images/logo-secondary.png' %}"
            alt="SustainAsoil logo"
            class="w-20 mr-2 max-xl:w-32"
            draggable="false"
            style="pointer-events: none; -khtml-user-select: none; -o-user-select: none; -moz-user-select: none; -webkit-user-select: none; user-select: none; user-drag: none;"
    />

    <h1
            class="text-base font-light tracking-[5px] max-xl:hidden text-accent2"
    >
        SUSTAIN<span class="text-2xl font-light">A</span>SOIL
    </h1>
</div>

<!-- Content - Start -->
<main class="flex flex-grow">
    <!-- Background Image -->
    <aside class="aside-container max-xl:hidden w-full max-lg:flex-shrink-0">
        <img
                src="{% static 'images/background-image.png' %}"
                alt="Plant image"
                class="object-cover h-full w-full object-right"
                draggable="false"
                style="pointer-events: none; -khtml-user-select: none; -o-user-select: none; -moz-user-select: none; -webkit-user-select: none; user-select: none; user-drag: none;"
        />
    </aside>

    <!-- Sign In Form -->
    <section
            class="section-container flex w-[80%] max-xl:justify-center max-xl:w-full"
    >

        <form
                id="login-form"
                action=""
                method="post"
                class="sign-in flex items-center flex-col mt-16 w-[90%]"
        >
            {% csrf_token %}
            <h1 class="font-bold text-2xl tracking-wide mb-4 text-accent1">
                FORGOT PASSWORD
            </h1>

            <p class="text-sm text-center mb-4">Enter your email and we'll send you a <br> link to reset your password</p>


            <!-- Sign In Form Container -->
            <div class="flex flex-col items-center w-full">

                <!-- Email Address -->
                <div
                        class="emailADDRESS w-[300px] flex items-center max-xl:w-[300px] mb-6 relative focus-within:text-accent1 tracking-wider"
                >
                    <!-- Icon -->
                    <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="currentColor"
                            class="emailICON w-5 h-5 absolute ml-3 mt-1 text-accent1"
                    >
                        <path
                                stroke-linecap="round"
                                d="M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"></path>
                    </svg>
                    <!-- Email Address Form -->
                    {{ form.acc_email }}
                </div>

            </div>


            <button
                    type="submit"
                    class="loginBTN border p-2 w-[300px] bg-accent1 font-bold text-sm tracking-widest text-background rounded-lg border-solid border-1 border-accent1 transition ease-in-out hover:duration-500 hover:bg-transparent hover:text-accent1 hover:font-bold"
            >
                SUMBIT
            </button>
            <!-- Log In Button -->

            <!-- Redirect to Sign In Page -->
            <div class="mt-3">
                <a href="{% url 'login_page' %}" class="forgot_password text-xs tracking-widest">
                    BACK TO LOGIN
                </a>
            </div>
        </form>
        <!-- Sign In Form - End -->

        <!-- Email Found Message -->
        <div class="sign-in flex items-center flex-col mt-16 w-[90%] hidden">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-11 h-11 text-accent1 mb-2"> <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /> </svg>
            <h1 class="font-normal text-2xl tracking-widest mb-8 text-accent1 w-[300px] text-center">
                EMAIL WAS SUCCESSFULLY SENT!
            </h1>

            <button
            type="submit"
            class="openGMAIL border p-2 w-[300px] bg-accent1 font-bold text-sm tracking-widest text-background rounded-lg border-solid border-1 border-accent1 transition ease-in-out hover:duration-500 hover:bg-transparent hover:text-accent1 hover:font-bold"
            >
                OPEN GMAIL
            </button>

            <!-- Redirect to Sign Up Page -->
            <div class="mt-3">
                <a href="{% url 'login_page' %}" class="forgot_password text-xs tracking-widest">
                    BACK TO LOGIN
                </a>
            </div>
        </div>
        <!-- End Email Found Message -->

    </section>
</main>
{% include 'preloader.html' %}
<!-- Include GSAP & Animation JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/gsap.min.js"></script>
<!-- Include jQuery from CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script src={% static 'js/main.js' %}></script>
<script>
    $('#preloader').hide();
    document.getElementById('preloader').style.display = 'none';
    $(document).ready(function () {
        $('#preloader').hide();

        $('#login-form').on('submit', function (event) {
            event.preventDefault(); // Prevent default form submission

            // Show the loader
            $('#preloader').show();

            // AJAX request to handle login
            $.ajax({
                type: 'POST',
                url: '{% url "login_page" %}',
                data: $(this).serialize(), // Serialize form data
                success: function (response) {
                    if (response.success) {
                        // Redirect to homepage upon successful login
                        window.location.href = "{% url 'homepage' %}";
                        // Successfull Icon - Check Mark
                        document.querySelector('.emailICON').innerHTML =  '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"> <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /> </svg>' + response.errors;

                    } else {
                        // Handle unsuccessful login (if needed)
                        console.log("Login unsuccessful");
                        // Unsuccessfull Icon - X Mark
                        document.querySelector('.emailICON').innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current mb-1 shrink-0 h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg> ' + response.errors;

                        // Hide the loader
                        $('#preloader').hide();
                        // Display error messages (if available)
                        if (response.errors) {
                            // Handle errors (display errors to the user)
                            console.log(response.errors);
                        }
                    }
                },
                error: function (xhr, errmsg, err) {
                    // Handle errors, if any
                    console.log(xhr.status + ": " + xhr.responseText);
                    // Hide the loader
                    $('#preloader').hide();
                }
            });
        });
    });

</script>
</body>
</html>
